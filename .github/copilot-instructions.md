<!-- Guidance for AI agents working on RDTI GA DOCX generator (v1.61) -->
- Purpose: ingest Radley JSON projects and emit GA DOCX files (docxtemplater); do not mutate repo files when generating output.
- Main pipeline: `normalizeProjectsInput` (accepts array or `{projects:[]}`) → `validateProject` (presence checks only—no truncation, limits handled upstream) → `renderDocxForProjects`. Projects are processed independently; failures are recorded per project and do not stop the loop.
- Required fields (see `src/types.ts`): `uid,name,description,startDate,endDate,createdAt,status,companyId,anzsrc,projectOwner{firstName,lastName,role,contactPhoneCountry,contactPhoneType,phone,email},coreActivities[],supportingActivities[]`. Preserve the intentional `supportingActivities.definiition` spelling end-to-end.
- DOCX renderer (`src/docx.ts`): docxtemplater + pizzip against `template/GA-Application-Template-Version-1.61-December-2024 (1).docx`; uses `{}` delimiters; **flat payload per project** (no `{#projects}` loop in template). Single core activity rendered as flat fields (`coreActivityName`, `coreActivityStartDate`, etc.); supporting activities use `{#supportingActivities}` loop. SupportingYes/No preformatted via `formatYesNo` (Unicode math-bold for chosen option, strikethrough for unchosen). Outputs `RDTI_GA_{uid}.docx` under `outputDir`.
- Public API (`src/index.ts`): `generateRDTIGADocx(projects, {outputDir?, dateFormat?, templatePath?})`. Errors aggregated per project.
- CLI (manual runs): `pnpm start -- examples/input.json [outputDir]`; default output dir `./output`; JSON can be array or `{projects:[]}`.
- Build/test: `pnpm build` emits ESM to `dist/` (functions import from there). `pnpm test` is currently a placeholder.
- Firebase emulator (`functions/src/index.ts`): install/build with `pnpm --dir functions install` then `pnpm --dir functions build`; serve via `pnpm --dir functions serve` (project demo-rdti, port 5001). Call `generateGaDocx` with `curl -X POST http://localhost:5001/demo-rdti/us-central1/generateGaDocx -H "Content-Type: application/json" --data @../examples/input.json`; outputs land in `functions/output`.
- Conventions: TypeScript ESM with explicit `.js` imports, 2-space indent, single quotes, trailing semicolons, ASCII-friendly output. Prefer reusing existing helpers; keep template names unchanged unless requirements change.